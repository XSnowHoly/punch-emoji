(function(t){function e(e){for(var n,s,c=e[0],r=e[1],u=e[2],h=0,f=[];h<c.length;h++)s=c[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,c=1;c<a.length;c++){var r=a[c];0!==i[r]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},o=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/punch-emoji/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=r;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0d6a":function(t,e,a){"use strict";a("d77d")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=(a("df49"),a("e7bd")),o=a("0c29"),s=a("cd5d"),c=a("6f24"),r=a("2696"),u=a("7c8a"),l=a("ae0c"),h=a("47fe"),f=a("4403"),p=a("1cf7"),d=a("7add"),g=a("84d6"),v=a("d2c1"),m=a("291f"),b=a("7ced"),y=a("09ad"),P=a("81c3"),C=a("6fe1"),w=a("a801"),M=a("031d"),k=a("63b4"),x=a("9173"),L=a("8344"),A=a("664d"),_=a("0124"),I=a("9736"),O=a("1cc1"),R=a("e231"),S=a("aea1"),j=a("5f4e"),V=a("0679"),X=a("2799"),Y=a("bdd9"),T=a("a2d2"),$=a("ba90"),D=a("36b6"),z=a("0f85");n["a"].use(i["a"]),n["a"].use(o["a"]),n["a"].use(s["a"]),n["a"].use(c["a"]),n["a"].use(r["a"]),n["a"].use(u["a"]),n["a"].use(l["a"]),n["a"].use(h["a"]),n["a"].use(f["a"]),n["a"].use(p["a"]),n["a"].use(d["a"]),n["a"].use(g["a"]),n["a"].use(v["a"]),n["a"].use(m["a"]),n["a"].use(b["a"]),n["a"].use(y["a"]),n["a"].use(P["a"]),n["a"].use(C["a"]),n["a"].use(w["a"]),n["a"].use(M["a"]),n["a"].use(k["a"]),n["a"].use(x["a"]),n["a"].use(L["a"]),n["a"].use(A["a"]),n["a"].use(_["a"]),n["a"].use(I["a"]),n["a"].use(O["a"]),n["a"].use(R["a"]),n["a"].use(S["a"]),n["a"].use(j["a"]),n["a"].use(V["a"]),n["a"].use(X["a"]),n["a"].use(Y["a"]),n["a"].use(T["a"]),n["a"].use($["a"]),n["a"].use(D["a"]),n["a"].use(z["a"]);var F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"punch-descript"},[t._v("👊😅👊 打拳就完事了~")]),t._m(0),a("div",{staticClass:"punch-list"},[a("h2",[t._v("拳头类型：")]),a("cube-checker",{attrs:{options:t.punchStyleList,type:"radio"},model:{value:t.checkPunchStyleValue,callback:function(e){t.checkPunchStyleValue=e},expression:"checkPunchStyleValue"}})],1),a("div",{staticClass:"punch-list"},[a("h2",[t._v("拳法：")]),a("cube-checker",{attrs:{options:t.punchMode,type:"radio"},model:{value:t.checkPunchModeValue,callback:function(e){t.checkPunchModeValue=e},expression:"checkPunchModeValue"}})],1),a("Notice"),a("input",{attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadImg}}),a("div",{staticClass:"action-box"},[a("cube-button",{attrs:{disabled:t.disablePlay},on:{click:function(e){return t.play()}}},[t._v("预览")]),a("cube-button",{attrs:{disabled:t.downlaodLock,primary:""},on:{click:function(e){return t.donwload()}}},[t._v("下载")])],1),a("cube-popup",{ref:"myPopup",attrs:{type:"my-popup"}},[a("div",{staticClass:"cropper-wrap"},[a("vue-cropper",{ref:"cropper",attrs:{autoCrop:"",outputSize:t.cropperOptions.outputSize,img:t.cropperImg,centerBox:""}}),a("cube-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:function(e){return t.getCropData()}}},[t._v("裁剪确定")])],1)])],1)},U=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"punch"},[a("canvas",{attrs:{id:"c",width:"240",height:"240"}})])}],B=a("5530"),E=(a("ac1f"),a("1276"),a("c975"),a("7a94")),N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"notice"},[a("div",{staticClass:"title"},[t._v("操作指南:")]),a("br"),t._v(" 可点击下方上传自定义图片，点击预览-> 下载, "),a("br"),t._v(" 图片过大的话生成 gif 需要点时间，请耐心等待几秒~ "),a("br"),t._v(" 如果图片下载失败，可能浏览器不支持，可尝试手机自带浏览器或谷歌、火狐浏览器 "),a("strike",[t._v("(等开发者修复)")])],1)},q=[],J={name:"Notice"},Q=J,G=(a("7976"),a("2877")),H=Object(G["a"])(Q,N,q,!1,null,"61936534",null),K=H.exports,W=a("fcd2"),Z=a.n(W),tt=a("f11c"),et=a.n(tt),at=a("b78c"),nt=a.n(at),it={name:"App",components:{Notice:K},data:function(){return{publicPath:"/punch-emoji/",checkPunchStyleValue:Z.a,punchStyleList:[{value:Z.a,text:"普通拳"},{value:et.a,text:"火焰拳"}],checkPunchModeValue:1,punchMode:[{value:1,text:"左右摆拳"},{value:2,text:"直拳"}],cropperImg:null,templateImg:nt.a,templateMoveCoords:[{left:5,top:20},{left:20,top:5},{left:35,top:20}],puncLeftMoveCoords:[{scaleX:.2,scaleY:.2,angle:-45,left:30,top:170},{scaleX:.35,scaleY:.35,angle:-10,left:60,top:150}],puncRightMoveCoords:[{scaleX:.2,scaleY:.2,angle:45,left:170,top:170},{scaleX:.35,scaleY:.35,angle:10,left:140,top:150}],straightPuncLeftMoveCoords:[{scaleX:.15,scaleY:.15,angle:0,left:50,top:165},{scaleX:.3,scaleY:.3,angle:0,left:50,top:165}],straightPuncRightMoveCoords:[{scaleX:.15,scaleY:.15,angle:0,left:150,top:165},{scaleX:.3,scaleY:.3,angle:0,left:150,top:165}],cropperOptions:{outputSize:1},disablePlay:!1,rect:null,canvas:null,index:0,opinion:!0,fistLeft:null,fistRight:null,fistLeftDone:!1,fistRightDone:!1,gifData:void 0,cap:null,downlaodLock:!1}},mounted:function(){this.canvas=new E["fabric"].StaticCanvas("c",{width:200,height:200,enableRetinaScaling:!1,backgroundColor:"#fff"}),this.templateImgInit(),this.fistLeftInit(),this.fistightInit()},watch:{checkPunchStyleValue:function(t){this.changePunchImage(t)},checkPunchModeValue:function(){this.play()}},methods:{templateImgInit:function(){var t=this,e=this.templateMoveCoords[0],a=e.left,n=e.top;E["fabric"].Image.fromURL(this.templateImg,(function(e){e.set({left:a,top:n,selectable:!1,scaleX:160/e.width,scaleY:160/e.height}),t.rect=e,t.canvas.add(t.rect),t.rect.sendToBack()}))},fistLeftInit:function(){var t=this;E["fabric"].Image.fromURL(Z.a,(function(e){e.scale(.2),e.left=30,e.top=170,e.angle=-45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistLeft=e}))},fistightInit:function(){var t=this;E["fabric"].Image.fromURL(Z.a,(function(e){e.scale(.2),e.flipX=!0,e.left=170,e.top=170,e.angle=45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistRight=e}))},animate:function(){if(1===this.checkPunchModeValue){var t=[{left:5,top:20},{left:20,top:5},{left:35,top:20}];this.opinion?(this.index+=1,2===this.index&&(this.opinion=!1)):(this.index-=1,0===this.index&&(this.opinion=!0));var e=t[this.index];this.rect.animate(e,{duration:120,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.animate})}},straightPunchAvatarAnimate:function(){2===this.checkPunchModeValue&&this.rect.animate({left:20,top:5===this.rect.top?10:5},{duration:120,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.straightPunchAvatarAnimate})},fistAnimate:function(t){var e=this;if(1===this.checkPunchModeValue){var a={left:{target:this.fistLeft,done:"fistLeftDone",moveCoords:this.puncLeftMoveCoords},right:{target:this.fistRight,done:"fistRightDone",moveCoords:this.puncRightMoveCoords}},n=a[t],i="left"===t?function(){return e.fistAnimate("right")}:function(){return e.fistAnimate("left")};n.target.animate(this[[n.done]]?n.moveCoords[0]:n.moveCoords[1],{duration:100,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:i,easing:E["fabric"].util.ease.easeOutCubic}),this[[n.done]]=!this[[n.done]]}},straightPunchAnimate:function(t){var e=this;if(2===this.checkPunchModeValue){var a={left:{target:this.fistLeft,done:"fistLeftDone",moveCoords:this.straightPuncLeftMoveCoords},right:{target:this.fistRight,done:"fistRightDone",moveCoords:this.straightPuncRightMoveCoords}},n=a[t],i="left"===t?function(){return e.straightPunchAnimate("right")}:function(){return e.straightPunchAnimate("left")};n.target.animate(this[[n.done]]?n.moveCoords[0]:n.moveCoords[1],{duration:50,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:i,easing:E["fabric"].util.ease.easeOutQuad}),this[[n.done]]=!this[[n.done]]}},play:function(){this.disablePlay=!0;var t={1:"leftRightPunchMode",2:"straightPunchMode"};this[t[this.checkPunchModeValue]]()},leftRightPunchMode:function(){this.animate(),this.fistAnimate("left")},straightPunchMode:function(){this.straightPunchAvatarAnimate(),this.straightPunchAnimate("left")},changeImage:function(t){var e=this,a=this.templateMoveCoords[0],n=a.left,i=a.top;this.rect.setSrc(t,(function(t){e.rect.set({left:n,top:i,selectable:!1,scaleX:160/t.width,scaleY:160/t.height}),e.canvas.renderAll()}))},changePunchImage:function(t){var e=this;this.fistLeft.setSrc(t,(function(){e.fistLeft.set(Object(B["a"])(Object(B["a"])({},e.puncLeftMoveCoords[0]),{},{selectable:!1,originX:"center",originY:"center"})),e.canvas.renderAll()})),this.fistRight.setSrc(t,(function(){e.fistRight.set(Object(B["a"])(Object(B["a"])({},e.puncRightMoveCoords[0]),{},{selectable:!1,originX:"center",originY:"center"})),e.canvas.renderAll()}))},uploadImg:function(t){var e=this,a=window.event||t,n=a.target.files[0],i=4194304;if(console.log(n.type.split("/")[1]),["jpeg","png","gif","jpg"].indexOf(n.type.split("/")[1])<0){var o=this.$createToast({time:1e3,type:"warn",txt:"仅可以上传图片格式文件"});o.show()}else if(n.size>i){var s=this.$createToast({time:1e3,type:"warn",txt:"文件最大为4MB"});s.show()}else{var c=this.$createToast({time:0,txt:"图片上传中"});c.show();try{var r=new FileReader;r.readAsDataURL(n),r.onload=function(){c.hide(),e.cropperImg=r.result;var t=e.$refs["myPopup"];t.show()}}catch(l){var u=this.$createToast({time:1e3,type:"warn",txt:"图片上传失败，请重试"});u.show()}}},donwload:function(){var t=this;if(this.disablePlay){this.downlaodLock=!0,setTimeout((function(){t.downlaodLock=!1}),5e3);var e=document.querySelector("canvas"),a=new window.CCapture({framerate:40,timeLimit:1.5,name:"punch",format:"gif",workersPath:this.publicPath}),n=this.$createToast({time:1e3,txt:"生成gif图片中...",type:"loading"});n.show(),a.start(),o()}else{var i=this.$createToast({txt:"请先点击预览再下载",type:"warn"});i.show()}function o(){requestAnimationFrame(o),a&&a.capture(e)}},getCropData:function(){var t=this;this.$refs.cropper.getCropData((function(e){t.templateImg=e,t.changeImage(e),t.$refs["myPopup"].hide()}))}}},ot=it,st=(a("0d6a"),Object(G["a"])(ot,F,U,!1,null,"e2049ce2",null)),ct=st.exports,rt=a("7e79"),ut=a.n(rt);n["a"].use(ut.a),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(ct)}}).$mount("#app")},"5ac6":function(t,e,a){},7976:function(t,e,a){"use strict";a("5ac6")},b78c:function(t,e,a){t.exports=a.p+"img/hehe.c7876904.png"},d77d:function(t,e,a){},f11c:function(t,e,a){t.exports=a.p+"img/punch.b8b9a18e.png"},fcd2:function(t,e,a){t.exports=a.p+"img/fist.87bac40b.png"}});
//# sourceMappingURL=app.5dad4278.js.map