(function(t){function e(e){for(var n,o,r=e[0],c=e[1],u=e[2],f=0,p=[];f<r.length;f++)o=r[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(p.length)p.shift()();return s.push.apply(s,u||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/punch-emoji/dist/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=(a("df49"),a("e7bd")),s=a("0c29"),o=a("cd5d"),r=a("6f24"),c=a("2696"),u=a("7c8a"),l=a("ae0c"),f=a("47fe"),p=a("4403"),d=a("1cf7"),h=a("7add"),g=a("84d6"),m=a("d2c1"),v=a("291f"),b=a("7ced"),y=a("09ad"),w=a("81c3"),C=a("6fe1"),x=a("a801"),I=a("031d"),_=a("63b4"),L=a("9173"),O=a("8344"),P=a("664d"),R=a("0124"),j=a("9736"),k=a("1cc1"),A=a("e231"),D=a("aea1"),S=a("5f4e"),T=a("0679"),$=a("2799"),X=a("bdd9"),M=a("a2d2"),Y=a("ba90"),z=a("36b6"),F=a("0f85");n["a"].use(i["a"]),n["a"].use(s["a"]),n["a"].use(o["a"]),n["a"].use(r["a"]),n["a"].use(c["a"]),n["a"].use(u["a"]),n["a"].use(l["a"]),n["a"].use(f["a"]),n["a"].use(p["a"]),n["a"].use(d["a"]),n["a"].use(h["a"]),n["a"].use(g["a"]),n["a"].use(m["a"]),n["a"].use(v["a"]),n["a"].use(b["a"]),n["a"].use(y["a"]),n["a"].use(w["a"]),n["a"].use(C["a"]),n["a"].use(x["a"]),n["a"].use(I["a"]),n["a"].use(_["a"]),n["a"].use(L["a"]),n["a"].use(O["a"]),n["a"].use(P["a"]),n["a"].use(R["a"]),n["a"].use(j["a"]),n["a"].use(k["a"]),n["a"].use(A["a"]),n["a"].use(D["a"]),n["a"].use(S["a"]),n["a"].use(T["a"]),n["a"].use($["a"]),n["a"].use(X["a"]),n["a"].use(M["a"]),n["a"].use(Y["a"]),n["a"].use(z["a"]),n["a"].use(F["a"]);var U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"punch-descript"},[t._v("👊😅👊 打拳就完事了~")]),t._m(0),a("div",{staticClass:"notice"},[a("div",{staticClass:"title"},[t._v("操作指南:")]),a("br"),t._v(" 可点击下方上传自定义图片，点击预览-> 下载, "),a("br"),t._v(" 图片过大的话生成 gif 需要点时间，请耐心等待几秒~ "),a("br"),t._v(" 如果图片下载失败，可能浏览器不支持，可尝试手机自带浏览器或谷歌、火狐浏览器 "),a("strike",[t._v("(等开发者修复)")])],1),a("input",{attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadImg}}),a("div",{staticClass:"action-box"},[a("cube-button",{attrs:{disabled:t.disablePlay},on:{click:function(e){return t.play()}}},[t._v("预览")]),a("cube-button",{attrs:{disabled:t.downlaodLock,primary:""},on:{click:function(e){return t.donwload()}}},[t._v("下载")])],1),a("cube-popup",{ref:"myPopup",attrs:{type:"my-popup"}},[a("div",{staticClass:"cropper-wrap"},[a("vue-cropper",{ref:"cropper",attrs:{autoCrop:"",outputSize:t.cropperOptions.outputSize,img:t.cropperImg,centerBox:""}}),a("cube-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary"},on:{click:function(e){return t.getCropData()}}},[t._v("裁剪确定")])],1)])],1)},B=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"punch"},[a("canvas",{attrs:{id:"c",width:"240",height:"240"}})])}],q=(a("ac1f"),a("1276"),a("c975"),a("7a94")),E=a("fcd2"),J=a.n(E),G=a("b78c"),H=a.n(G),K={name:"App",components:{},data:function(){return{publicPath:"/punch-emoji/dist/",cropperImg:null,templateImg:H.a,templateMoveCoords:[{left:5,top:20},{left:20,top:5},{left:35,top:20}],cropperOptions:{outputSize:1},disablePlay:!1,rect:null,canvas:null,index:0,opinion:!0,fistLeft:null,fistRgiht:null,fistLeftDone:!1,fistRightDone:!1,gifData:void 0,cap:null,downlaodLock:!1}},mounted:function(){this.canvas=new q["fabric"].StaticCanvas("c",{width:200,height:200,enableRetinaScaling:!1,backgroundColor:"#ccc"}),this.templateImgInit(),this.fistLeftInit(),this.fistightInit()},methods:{templateImgInit:function(){var t=this,e=this.templateMoveCoords[0],a=e.left,n=e.top;q["fabric"].Image.fromURL(this.templateImg,(function(e){e.set({left:a,top:n,selectable:!1,scaleX:160/e.width,scaleY:160/e.height}),t.rect=e,t.canvas.add(t.rect),t.rect.sendToBack()}))},fistLeftInit:function(){var t=this;q["fabric"].Image.fromURL(J.a,(function(e){e.scale(.2),e.left=30,e.top=170,e.angle=-45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistLeft=e}))},fistightInit:function(){var t=this;q["fabric"].Image.fromURL(J.a,(function(e){e.scale(.2),e.flipX=!0,e.left=170,e.top=170,e.angle=45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistRgiht=e}))},animate:function(){var t=[{left:5,top:20},{left:20,top:5},{left:35,top:20}];this.opinion?(this.index+=1,2===this.index&&(this.opinion=!1)):(this.index-=1,0===this.index&&(this.opinion=!0));var e=t[this.index];this.rect.animate(e,{duration:120,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.animate})},fistAnimate:function(){var t=[{scaleX:.2,scaleY:.2,angle:-45,left:30,top:170},{scaleX:.35,scaleY:.35,angle:-10,left:60,top:150}];this.fistLeft.animate(this.fistLeftDone?t[0]:t[1],{duration:100,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.fistRightAnimate,easing:q["fabric"].util.ease.easeOutCubic}),this.fistLeftDone=!this.fistLeftDone},fistRightAnimate:function(){var t=[{scaleX:.2,scaleY:.2,angle:45,left:170,top:170},{scaleX:.35,scaleY:.35,angle:10,left:140,top:150}];this.fistRgiht.animate(this.fistRightDone?t[0]:t[1],{duration:100,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.fistAnimate}),this.fistRightDone=!this.fistRightDone},play:function(){this.disablePlay=!0,this.animate(),this.fistAnimate()},changeImage:function(t){var e=this,a=this.templateMoveCoords[0],n=a.left,i=a.top;this.rect.setSrc(t,(function(t){e.rect.set({left:n,top:i,selectable:!1,scaleX:160/t.width,scaleY:160/t.height}),e.canvas.renderAll()})),this.canvas.renderAll(),this.canvas.calcOffset()},uploadImg:function(t){var e=this,a=window.event||t,n=a.target.files[0],i=4194304;if(console.log(n.type.split("/")[1]),["jpeg","png","gif","jpg"].indexOf(n.type.split("/")[1])<0){var s=this.$createToast({time:1e3,type:"warn",txt:"仅可以上传图片格式文件"});s.show()}else if(n.size>i){var o=this.$createToast({time:1e3,type:"warn",txt:"文件最大为4MB"});o.show()}else{var r=new FileReader;r.readAsDataURL(n),r.onload=function(){e.cropperImg=r.result;var t=e.$refs["myPopup"];t.show()}}},donwload:function(){var t=this;if(this.disablePlay){this.downlaodLock=!0,setTimeout((function(){t.downlaodLock=!1}),5e3);var e=document.querySelector("canvas"),a=new window.CCapture({framerate:35,timeLimit:1.3,name:"punch",format:"gif",workersPath:this.publicPath}),n=this.$createToast({time:1e3,txt:"生成gif图片中...",type:"loading"});n.show(),a.start(),s()}else{var i=this.$createToast({txt:"请先点击预览再下载",type:"warn"});i.show()}function s(){requestAnimationFrame(s),a&&a.capture(e)}},getCropData:function(){var t=this;this.$refs.cropper.getCropData((function(e){t.templateImg=e,t.changeImage(e),t.$refs["myPopup"].hide()}))}}},N=K,Q=(a("cc85"),a("2877")),V=Object(Q["a"])(N,U,B,!1,null,"105f34a0",null),W=V.exports,Z=a("7e79"),tt=a.n(Z);n["a"].use(tt.a),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(W)}}).$mount("#app")},b78c:function(t,e,a){t.exports=a.p+"img/hehe.c7876904.png"},c90d:function(t,e,a){},cc85:function(t,e,a){"use strict";a("c90d")},fcd2:function(t,e,a){t.exports=a.p+"img/fist.87bac40b.png"}});
//# sourceMappingURL=app.edf40d85.js.map