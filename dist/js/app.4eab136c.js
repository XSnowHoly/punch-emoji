(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);f&&f(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var f=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=(a("df49"),a("e7bd")),s=a("0c29"),o=a("cd5d"),r=a("6f24"),c=a("2696"),l=a("7c8a"),f=a("ae0c"),u=a("47fe"),p=a("4403"),h=a("1cf7"),d=a("7add"),g=a("84d6"),m=a("d2c1"),b=a("291f"),v=a("7ced"),y=a("09ad"),w=a("81c3"),x=a("6fe1"),I=a("a801"),C=a("031d"),O=a("63b4"),R=a("9173"),L=a("8344"),P=a("664d"),A=a("0124"),_=a("9736"),j=a("1cc1"),D=a("e231"),T=a("aea1"),S=a("5f4e"),X=a("0679"),k=a("2799"),Y=a("bdd9"),M=a("a2d2"),$=a("ba90"),F=a("36b6"),U=a("0f85");n["a"].use(i["a"]),n["a"].use(s["a"]),n["a"].use(o["a"]),n["a"].use(r["a"]),n["a"].use(c["a"]),n["a"].use(l["a"]),n["a"].use(f["a"]),n["a"].use(u["a"]),n["a"].use(p["a"]),n["a"].use(h["a"]),n["a"].use(d["a"]),n["a"].use(g["a"]),n["a"].use(m["a"]),n["a"].use(b["a"]),n["a"].use(v["a"]),n["a"].use(y["a"]),n["a"].use(w["a"]),n["a"].use(x["a"]),n["a"].use(I["a"]),n["a"].use(C["a"]),n["a"].use(O["a"]),n["a"].use(R["a"]),n["a"].use(L["a"]),n["a"].use(P["a"]),n["a"].use(A["a"]),n["a"].use(_["a"]),n["a"].use(j["a"]),n["a"].use(D["a"]),n["a"].use(T["a"]),n["a"].use(S["a"]),n["a"].use(X["a"]),n["a"].use(k["a"]),n["a"].use(Y["a"]),n["a"].use(M["a"]),n["a"].use($["a"]),n["a"].use(F["a"]),n["a"].use(U["a"]);var q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t._m(0),a("input",{attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadImg}}),a("div",{staticClass:"action-box"},[a("cube-button",{attrs:{disabled:t.disablePlay},on:{click:function(e){return t.play()}}},[t._v("预览")]),a("cube-button",{attrs:{primary:""},on:{click:function(e){return t.donwload()}}},[t._v("下载")])],1)])},B=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("canvas",{attrs:{id:"c",width:"240",height:"240"}})])}],E=(a("ac1f"),a("1276"),a("c975"),a("7a94")),J=a("fcd2"),z=a.n(J),G=a("b78c"),H=a.n(G),K={name:"App",components:{},data:function(){return{publicPath:"/dist/",templateImg:H.a,templateMoveCoords:[{left:5,top:20},{left:20,top:5},{left:35,top:20}],disablePlay:!1,rect:null,canvas:null,index:0,opinion:!0,fistLeft:null,fistRgiht:null,fistLeftDone:!1,fistRightDone:!1,gifData:void 0,cap:null}},mounted:function(){this.canvas=new E["fabric"].StaticCanvas("c",{width:240,height:240,enableRetinaScaling:!1,backgroundColor:"#fff"}),this.templateImgInit(),this.fistLeftInit(),this.fistightInit()},methods:{templateImgInit:function(){var t=this,e=this.templateMoveCoords[0],a=e.left,n=e.top;E["fabric"].Image.fromURL(this.templateImg,(function(e){e.set({left:a,top:n,selectable:!1,scaleX:200/e.width,scaleY:200/e.height}),t.rect=e,t.canvas.add(t.rect),t.rect.sendToBack()}))},fistLeftInit:function(){var t=this;E["fabric"].Image.fromURL(z.a,(function(e){e.scale(.2),e.left=30,e.top=200,e.angle=-45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistLeft=e}))},fistightInit:function(){var t=this;E["fabric"].Image.fromURL(z.a,(function(e){e.scale(.2),e.flipX=!0,e.left=210,e.top=200,e.angle=45,e.selectable=!1,e.originX=e.originY="center",t.canvas.bringToFront(e),t.canvas.add(e),t.fistRgiht=e}))},animate:function(){var t=[{left:5,top:20},{left:20,top:5},{left:35,top:20}];this.opinion?(this.index+=1,2===this.index&&(this.opinion=!1)):(this.index-=1,0===this.index&&(this.opinion=!0));var e=t[this.index];this.rect.animate(e,{duration:120,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.animate})},fistAnimate:function(){var t=[{scaleX:.2,scaleY:.2,angle:-45,left:30,top:200},{scaleX:.4,scaleY:.4,angle:-10,left:60,top:180}];this.fistLeft.animate(this.fistLeftDone?t[0]:t[1],{duration:100,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.fistRightAnimate,easing:E["fabric"].util.ease.easeOutCubic}),this.fistLeftDone=!this.fistLeftDone},fistRightAnimate:function(){var t=[{scaleX:.2,scaleY:.2,angle:45,left:210,top:200},{scaleX:.4,scaleY:.4,angle:10,left:180,top:180}];this.fistRgiht.animate(this.fistRightDone?t[0]:t[1],{duration:100,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:this.fistAnimate}),this.fistRightDone=!this.fistRightDone},play:function(){this.disablePlay=!0,this.animate(),this.fistAnimate()},changeImage:function(t){var e=this;this.rect.setSrc(t,(function(t){e.rect.set({left:40,top:40,selectable:!1,scaleX:200/t.width,scaleY:200/t.height}),e.canvas.renderAll()})),this.canvas.renderAll(),this.canvas.calcOffset()},uploadImg:function(t){var e=this;console.log("开始上传");var a=window.event||t,n=a.target.files[0],i=4194304;if(console.log(n.type.split("/")[1]),["jpeg","png","gif","jpg"].indexOf(n.type.split("/")[1])<0){var s=this.$createToast({time:1e3,type:"warn",txt:"仅可以上传图片格式文件"});s.show()}else if(n.size>i){var o=this.$createToast({time:1e3,type:"warn",txt:"文件最大为4MB"});o.show()}else{var r=new FileReader;r.readAsDataURL(n),r.onload=function(){e.templateImg=r.result,e.changeImage(r.result)}}},donwload:function(){if(this.disablePlay){var t=document.querySelector("canvas"),e=new window.CCapture({framerate:30,quality:1,timeLimit:1.2,name:"punch",format:"gif",workersPath:this.publicPath}),a=this.$createToast({time:1e3,txt:"生成gif图片中...",type:"loading"});a.show(),e.start(),i()}else{var n=this.$createToast({txt:"请先点击预览再下载",type:"warn"});n.show()}function i(){requestAnimationFrame(i),e&&e.capture(t)}}}},N=K,Q=(a("fab4"),a("2877")),V=Object(Q["a"])(N,q,B,!1,null,"6b286f3b",null),W=V.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(W)}}).$mount("#app")},"67f9":function(t,e,a){},b78c:function(t,e,a){t.exports=a.p+"img/hehe.c7876904.png"},fab4:function(t,e,a){"use strict";a("67f9")},fcd2:function(t,e,a){t.exports=a.p+"img/fist.87bac40b.png"}});
//# sourceMappingURL=app.4eab136c.js.map